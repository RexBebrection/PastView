(()=>{"use strict";var e={443:(e,t,s)=>{var a=s(751),o=s(641);function i(e,t){const s=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)(o.FK,null,[t[0]||(t[0]=(0,o.Lk)("nav",null,null,-1)),(0,o.bF)(s)],64)}var r=s(262);const n={},l=(0,r.A)(n,[["render",i]]),c=l;var u=s(220),d=s(33);const p={class:"home"},h={class:"home-content"},g={class:"home-info-container"},m={class:"map-border"},k={ref:"mapContainer",class:"map"},v={class:"home-info-list"},b={class:"search-bar"},L=["onClick"],f={class:"street-name"},y={class:"profile-info-home"},C=["src"],w={class:"profile-name"},D={key:0,class:"location-details"},U={class:"location-details-left"},F={class:"location-details-data"},I={class:"location-details-comments"},E={class:"comments"},x={key:0},_=["src"],X={class:"comment-username"},P={class:"comment-text"},Q={class:"location-details-right"},M=["src"],A={class:"location-navigation"},$=["disabled"],j=["disabled"],S={class:"fullscreen-content"},N={class:"fullscreen-street"},J=["src"];function H(e,t,s,i,r,n){const l=(0,o.g2)("Navbar"),c=(0,o.g2)("Footer");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(l),(0,o.Lk)("div",p,[(0,o.Lk)("div",h,[t[9]||(t[9]=(0,o.Lk)("p",{class:"home-title"},"Інтерактивна ретро-карта міста Львів",-1)),(0,o.Lk)("div",g,[(0,o.Lk)("div",m,[(0,o.Lk)("div",k,null,512)]),(0,o.Lk)("div",v,[(0,o.Lk)("div",b,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.searchQuery=e),placeholder:"Пошук..."},null,512),[[a.Jo,r.searchQuery]])]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.filteredItems,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{class:"home-info-item",key:t,onClick:t=>n.focusOnLocation(e)},[(0,o.Lk)("div",f,(0,d.v_)(e.street),1),(0,o.Lk)("div",y,[(0,o.Lk)("img",{src:e.profileImage,alt:"Profile",class:"profile-image-home"},null,8,C),(0,o.Lk)("p",w,(0,d.v_)(e.username),1)])],8,L)))),128))])]),r.selectedLocation?((0,o.uX)(),(0,o.CE)("div",D,[(0,o.Lk)("div",U,[(0,o.Lk)("div",F,[(0,o.Lk)("p",null,(0,d.v_)(r.selectedLocation.street),1),(0,o.Lk)("p",null,"Copyright: @"+(0,d.v_)(r.selectedLocation.username),1)]),(0,o.Lk)("div",I,[(0,o.Lk)("form",{onSubmit:t[2]||(t[2]=(0,a.D$)(((...e)=>n.addComment&&n.addComment(...e)),["prevent"]))},[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>r.newComment=e),placeholder:"Напиши коментар..."},null,512),[[a.Jo,r.newComment]]),t[8]||(t[8]=(0,o.Lk)("button",{type:"submit"},"Додати",-1))],32),(0,o.Lk)("div",E,[0===r.comments.length?((0,o.uX)(),(0,o.CE)("p",x,"Коментарів поки немає.")):(0,o.Q3)("",!0),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.comments,((e,t)=>((0,o.uX)(),(0,o.CE)("li",{key:t,class:"comment-item"},[(0,o.Lk)("img",{src:e.profileImage,alt:"avatar",class:"comment-avatar"},null,8,_),(0,o.Lk)("div",null,[(0,o.Lk)("p",X,(0,d.v_)(e.username),1),(0,o.Lk)("p",P,(0,d.v_)(e.text),1)])])))),128))])])])]),(0,o.Lk)("div",Q,[(0,o.Lk)("img",{src:r.selectedLocation.locationImage,onClick:t[3]||(t[3]=e=>n.openFullscreen()),alt:"Large Location",class:"large-photo"},null,8,M),(0,o.Lk)("div",A,[(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>n.goToPreviousLocation&&n.goToPreviousLocation(...e)),disabled:!n.hasPrevious}," ← ",8,$),(0,o.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>n.goToNextLocation&&n.goToNextLocation(...e)),disabled:!n.hasNext},"→",8,j)])])])):(0,o.Q3)("",!0)])]),r.isFullscreenVisible?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"fullscreen-overlay",onClick:t[7]||(t[7]=(0,a.D$)(((...e)=>n.closeFullscreen&&n.closeFullscreen(...e)),["self"]))},[(0,o.Lk)("div",S,[(0,o.Lk)("p",N,(0,d.v_)(r.selectedLocation.street)+" Copyright: @"+(0,d.v_)(r.selectedLocation.username),1),(0,o.Lk)("img",{src:r.selectedLocation.locationImage,alt:"Location",class:"fullscreen-image"},null,8,J),(0,o.Lk)("button",{class:"close-btn",onClick:t[6]||(t[6]=(...e)=>n.closeFullscreen&&n.closeFullscreen(...e))},"✕")])])):(0,o.Q3)("",!0),(0,o.bF)(c)],64)}const z=s.p+"img/Logo(big).03776db6.png",q={class:"navbar"},T={class:"navbar-menu"},R={key:0,class:"navbar-start"},Z={key:3,href:"mailto:someone@example.com",class:"navbar-item",id:"link"},G={class:"navbar-profile"},K={class:"profile-pic-wrapper"},B=["src"],O={class:"navbar-profile-email"};function W(e,t,s,a,i,r){const n=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("nav",null,[(0,o.Lk)("div",q,[(0,o.bF)(n,{to:"/home",class:"navbar-item"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.Lk)("div",{class:"navbar-brand"},[(0,o.Lk)("img",{src:z})],-1)]))),_:1}),(0,o.Lk)("div",T,[i.user?((0,o.uX)(),(0,o.CE)("div",R,[(0,o.bF)(n,{to:"/home",class:"navbar-item",id:"link"},{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.eW)("Головна")]))),_:1}),"moderator"!==i.user.role?((0,o.uX)(),(0,o.Wv)(n,{key:0,to:"/create-location",class:"navbar-item",id:"link"},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)("Додати локацію")]))),_:1})):(0,o.Q3)("",!0),"moderator"!==i.user.role?((0,o.uX)(),(0,o.Wv)(n,{key:1,to:"/my-publications",class:"navbar-item",id:"link"},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)(" Мої публікації ")]))),_:1})):(0,o.Q3)("",!0),"moderator"==i.user.role?((0,o.uX)(),(0,o.Wv)(n,{key:2,to:"/approve",class:"navbar-item",id:"link"},{default:(0,o.k6)((()=>t[4]||(t[4]=[(0,o.eW)(" Підтвердження ")]))),_:1})):(0,o.Q3)("",!0),"moderator"!==i.user.role?((0,o.uX)(),(0,o.CE)("a",Z," Написати відгук ")):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",G,[i.user?((0,o.uX)(),(0,o.Wv)(n,{key:0,to:"/profile",class:"navbar-profile-link",id:"link"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",K,[(0,o.Lk)("img",{src:i.user.profilePicture,alt:"Profile"},null,8,B)]),(0,o.Lk)("p",O,(0,d.v_)(i.user.email),1)])),_:1})):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.bF)(n,{to:"/login",class:"navbar-item",id:"link"},{default:(0,o.k6)((()=>t[5]||(t[5]=[(0,o.eW)("Увійти")]))),_:1}),(0,o.bF)(n,{to:"/registration",class:"navbar-item",id:"link"},{default:(0,o.k6)((()=>t[6]||(t[6]=[(0,o.eW)("Зареєструватись")]))),_:1})],64))])])])}var V=s(783),Y=s(884);const ee={data(){return{user:null}},created(){const e=(0,V.xI)();e.onAuthStateChanged((async e=>{e?(this.user=e,await this.fetchUserData(e.uid)):this.user=null}))},methods:{async fetchUserData(e){const t=(0,Y.aU)(),s=(0,Y.H9)(t,"users",e),a=await(0,Y.x7)(s);a.exists()?this.user={...this.user,...a.data()}:console.log("User not found in Firestore")},async logout(){try{await signOut((0,V.xI)()),this.$router.push("/")}catch(e){console.error("Logout error",e)}}}},te=(0,r.A)(ee,[["render",W],["__scopeId","data-v-5a3ad73c"]]),se=te,ae={class:"footer"};function oe(e,t){return(0,o.uX)(),(0,o.CE)("div",ae,t[0]||(t[0]=[(0,o.Lk)("img",{src:z},null,-1)]))}const ie={},re=(0,r.A)(ie,[["render",oe],["__scopeId","data-v-1a9f94d3"]]),ne=re;var le=s(842),ce=s.n(le);const ue={components:{Navbar:se,Footer:ne},data(){return{searchQuery:"",locations:[],map:null,selectedLocation:null,comments:[],newComment:"",currentUser:{username:"",profileImage:""},isFullscreenVisible:!1}},computed:{filteredItems(){return this.locations.filter((e=>e.street.toLowerCase().includes(this.searchQuery.toLowerCase())))},currentIndex(){return this.locations.findIndex((e=>e.id===this.selectedLocation?.id))},hasPrevious(){return this.currentIndex>0},hasNext(){return this.currentIndex<this.locations.length-1}},watch:{selectedLocation(e){e&&this.loadComments(e.id)}},methods:{async fetchLocations(){const e=(0,Y.aU)(),t=(0,Y.P)((0,Y.rJ)(e,"locations"),(0,Y._M)("status","==","approved")),s=await(0,Y.GG)(t),a=await Promise.all(s.docs.map((async t=>{const s=t.data(),a=s.coordinates;if(!a||isNaN(a.lat)||isNaN(a.lng))return console.error(`Некоректні координати для локації ${t.id}`),null;const o=s.userUid,i=(0,Y.H9)(e,"users",o),r=await(0,Y.x7)(i);let n="/default-avatar.png",l="Анонім";if(r.exists()){const e=r.data();n=e.profilePicture||n,l=e.username||l}else console.error(`Не знайдено користувача з UID ${o}`);return{id:t.id,street:s.address,profileImage:n,username:l,coordinates:[a.lng,a.lat],locationImage:s.imageUrl||"/default-location.jpg"}})));this.locations=a.filter((e=>null!==e)),this.locations.forEach((e=>{const t=document.createElement("div");t.className="custom-marker",t.style.backgroundImage="url('https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2FPointerBlicking.png?alt=media&token=836b276d-467a-4239-8848-8a6ce42a941e')",t.style.width="40px",t.style.height="40px",t.style.backgroundSize="cover",t.style.cursor="pointer";new(ce().Marker)(t).setLngLat(e.coordinates).setPopup((new(ce().Popup)).setHTML(`\n        <img class="photo-preview" src="${e.locationImage}" alt="Location Photo" ">\n        <p class="text-preview" style="margin-top: 4px;">${e.street}</p>\n      `)).addTo(this.map);t.addEventListener("click",(()=>{this.selectedLocation=e}))}))},focusOnLocation(e){this.map.flyTo({center:e.coordinates,zoom:15}),this.selectedLocation=e},async addComment(){if(!this.newComment.trim()||!this.selectedLocation)return;const e=(0,V.xI)(),t=e.currentUser;if(!t)return void console.error("User is not logged in.");const s=(0,Y.aU)(),a=(0,Y.H9)(s,"users",t.uid),o=await(0,Y.x7)(a);if(!o.exists())return void console.error(`Користувач з UID ${t.uid} не знайдений.`);const i=o.data(),r=i.username||"Анонім",n=i.profilePicture||"/default-avatar.png",l=(0,Y.rJ)(s,"locations",this.selectedLocation.id,"comments");await(0,Y.gS)(l,{text:this.newComment,createdAt:new Date,userUid:t.uid,username:r,profileImage:n}),this.newComment="",this.loadComments(this.selectedLocation.id)},async loadComments(e){const t=(0,Y.aU)(),s=(0,Y.rJ)(t,"locations",e,"comments"),a=await(0,Y.GG)(s);this.comments=a.docs.map((e=>e.data()))},goToPreviousLocation(){if(this.hasPrevious){const e=this.locations[this.currentIndex-1];this.focusOnLocation(e)}},goToNextLocation(){if(this.hasNext){const e=this.locations[this.currentIndex+1];this.focusOnLocation(e)}},openFullscreen(){this.isFullscreenVisible=!0},closeFullscreen(){this.isFullscreenVisible=!1}},mounted(){ce().accessToken="pk.eyJ1IjoibHZxMWljZW1hbiIsImEiOiJjbHU4ZmtuZ2MwYzRvMm9yeGQzZnBycjBkIn0.u4QC3601L2OcFCzw8kzvmw",this.map=new(ce().Map)({container:this.$refs.mapContainer,style:"mapbox://styles/lvq1iceman/cm9ootxch009b01qs40wa1c8q",center:[24.0315,49.8397],zoom:13}),window.addEventListener("resize",(()=>{this.map&&this.map.resize()})),this.fetchLocations();const e=(0,V.xI)();(0,V.hg)(e,(async e=>{if(e){const t=(0,Y.aU)(),s=(0,Y.H9)(t,"users",e.uid),a=await(0,Y.x7)(s);if(!a.exists())return console.error(`Не знайдено користувача з UID ${userUid}`),null;{const t=a.data();t.profilePicture,t.username;if(a.exists()){const t=a.data();this.currentUser={uid:e.uid,username:t.username||"Анонім",profileImage:t.profilePicture||"/default-avatar.png"}}}}}))}},de=(0,r.A)(ue,[["render",H]]),pe=de,he={class:"start"},ge={class:"island"},me={class:"island-buttons"};function ke(e,t,s,a,i,r){const n=(0,o.g2)("BackgroundSlider"),l=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",he,[(0,o.bF)(n),(0,o.Lk)("div",ge,[t[3]||(t[3]=(0,o.Lk)("div",{class:"island-border"},[(0,o.Lk)("img",{src:z,alt:"Island",class:"island-image"}),(0,o.Lk)("p",{class:"island-text"}," Ласкаво просимо до Past View — унікального сервісу, що переносить вас у минуле міста. Натискайте на точки на карті, щоб побачити старовинні фотографії та дізнатися історії цих місць. Зареєструйтеся, щоб додавати власні знімки, коментувати й ділитися своїми враженнями. Відчуйте історію міста по-новому! ")],-1)),(0,o.Lk)("div",me,[(0,o.bF)(l,{to:"/home",class:"button-i"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.eW)("Почати")]))),_:1}),(0,o.bF)(l,{to:"/login",class:"button-i"},{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.eW)("Увійти")]))),_:1}),(0,o.bF)(l,{to:"/registration",class:"button-i"},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)("Зареєструватись")]))),_:1})])])])}const ve={class:"background-slider"},be={class:"gallery"},Le=["src"];function fe(e,t,s,a,i,r){return(0,o.uX)(),(0,o.CE)("div",ve,[(0,o.Lk)("div",be,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.images,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{class:(0,d.C4)(["gallery-item",{active:t===i.currentIndex}]),key:t},[(0,o.Lk)("img",{src:e,alt:"gallery-image"},null,8,Le)],2)))),128))])])}const ye={name:"BackgroundSlider",data(){return{currentIndex:0,images:["https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2Fbackground%2Flviv-zgori.png?alt=media&token=8560ad72-e2e9-4930-a069-3113a37b9455","https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2Fbackground%2Fdvometrovi-stiny-snigu-na-vul.-stryjskij.-foto-1920-1930-h-rr.%202.png?alt=media&token=085ed21c-1c34-4afb-a181-b89149a4409c","https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2Fbackground%2Fpelchinskiy-stav-i-tsitadel-u-1893-rotsi.png?alt=media&token=6da1184d-113b-41d1-b0fc-9203cbd9cd44","https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2Fbackground%2Ftramvay-12-yide-vniz-po-vul.-krivonosa.png?alt=media&token=f3ffc1b1-686c-406c-8c65-c60b1897aa1d"]}},mounted(){setInterval((()=>{this.currentIndex=(this.currentIndex+1)%this.images.length}),6e3)}},Ce=(0,r.A)(ye,[["render",fe],["__scopeId","data-v-48cad606"]]),we=Ce,De={components:{BackgroundSlider:we}},Ue=(0,r.A)(De,[["render",ke],["__scopeId","data-v-38f70244"]]),Fe=Ue,Ie={class:"start"},Ee={class:"login-container"},xe={class:"login-inputs"},_e={class:"login-buttons"},Xe=["onClick"],Pe={key:0,class:"error-text"};function Qe(e,t,s,i,r,n){const l=(0,o.g2)("BackgroundSlider"),c=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",Ie,[(0,o.bF)(l),(0,o.Lk)("div",Ee,[t[5]||(t[5]=(0,o.Lk)("img",{src:z,alt:"Logo",class:"logo-small"},null,-1)),t[6]||(t[6]=(0,o.Lk)("h2",{class:"login-title"},"Вхід",-1)),(0,o.Lk)("div",xe,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.email=e),type:"text",placeholder:"Логін",class:(0,d.C4)(["login-input",{"input-error":r.loginError}]),onKeyup:t[1]||(t[1]=(0,a.jR)(((...e)=>n.login&&n.login(...e)),["enter"]))},null,34),[[a.Jo,r.email]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.password=e),type:"password",placeholder:"Пароль",class:(0,d.C4)(["login-input",{"input-error":r.loginError}]),onKeyup:t[3]||(t[3]=(0,a.jR)(((...e)=>n.login&&n.login(...e)),["enter"]))},null,34),[[a.Jo,r.password]])]),(0,o.Lk)("div",_e,[(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>n.login&&n.login(...e)),class:"login-button"},"Увійти"),(0,o.bF)(c,{to:"/",custom:""},{default:(0,o.k6)((({navigate:e})=>[(0,o.Lk)("button",{onClick:e,class:"login-button"},"Скасувати",8,Xe)])),_:1})]),r.loginError?((0,o.uX)(),(0,o.CE)("div",Pe,"Неправильні логін або пароль")):(0,o.Q3)("",!0)])])}const Me={components:{BackgroundSlider:we},data(){return{email:"",password:"",loginError:!1}},methods:{async login(){const e=(0,V.xI)();try{await(0,V.x9)(e,this.email,this.password),console.log("Успішний вхід!"),this.$router.push("/home"),this.loginError=!1}catch(t){console.error("Помилка входу:",t.message),this.loginError=!0}}}},Ae=(0,r.A)(Me,[["render",Qe],["__scopeId","data-v-be9f99c2"]]),$e=Ae,je={class:"start"},Se={class:"registation-container"},Ne={class:"registation-inputs"},Je={key:0,class:"error-text"},He={key:1,class:"error-text"},ze={key:2,class:"error-text"},qe={class:"registation-buttons"},Te=["onClick"];function Re(e,t,s,i,r,n){const l=(0,o.g2)("BackgroundSlider"),c=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",je,[(0,o.bF)(l),(0,o.Lk)("div",Se,[t[4]||(t[4]=(0,o.Lk)("img",{src:z,alt:"Logo",class:"logo-small"},null,-1)),t[5]||(t[5]=(0,o.Lk)("h2",{class:"registation-title"},"Реєстрація",-1)),(0,o.Lk)("div",Ne,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.username=e),type:"text",placeholder:"Ім’я користувача",class:(0,d.C4)(["registation-input",{"input-error":r.usernameError}])},null,2),[[a.Jo,r.username]]),r.usernameError?((0,o.uX)(),(0,o.CE)("div",Je,"Ім’я користувача обов’язкове")):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.email=e),type:"text",placeholder:"Email",class:(0,d.C4)(["registation-input",{"input-error":r.emailError}])},null,2),[[a.Jo,r.email]]),r.emailError?((0,o.uX)(),(0,o.CE)("div",He,"Неправильний формат email")):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.password=e),type:"password",placeholder:"Пароль",class:(0,d.C4)(["registation-input",{"input-error":r.passwordError}])},null,2),[[a.Jo,r.password]]),r.passwordError?((0,o.uX)(),(0,o.CE)("div",ze," Пароль повинен містити мінімум 6 символів, цифри та букви ")):(0,o.Q3)("",!0)]),(0,o.Lk)("div",qe,[(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>n.register&&n.register(...e)),class:"registation-button"},"Зареєструватись"),(0,o.bF)(c,{to:"/",custom:""},{default:(0,o.k6)((({navigate:e})=>[(0,o.Lk)("button",{onClick:e,class:"registation-button"},"Скасувати",8,Te)])),_:1})])])])}const Ze={components:{BackgroundSlider:we},data(){return{username:"",email:"",password:"",usernameError:!1,emailError:!1,passwordError:!1}},methods:{validateEmail(e){const t=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;return t.test(e)},validatePassword(e){const t=/^(?=.*[a-zA-Z])(?=.*\d).{6,}$/;return t.test(e)},async register(){if(this.usernameError=!this.username.trim(),this.emailError=!this.validateEmail(this.email),this.passwordError=!this.validatePassword(this.password),this.usernameError||this.emailError||this.passwordError)return;const e=(0,V.xI)();try{const t=await(0,V.eJ)(e,this.email,this.password),s=t.user,a=(0,Y.aU)(),o=(0,Y.H9)(a,"users",s.uid);await(0,Y.BN)(o,{email:this.email,username:this.username,role:"user",profilePicture:"https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2Fuser.png?alt=media&token=af753285-18bf-417d-a385-d281769201e9",createdAt:new Date,uid:s.uid,role:"user",status:"active"}),console.log("Реєстрація та запис в Firestore успішні!"),this.$router.push("/home")}catch(t){console.error("Помилка реєстрації:",t.message),"auth/email-already-in-use"===t.code||"auth/invalid-email"===t.code?this.emailError=!0:"auth/weak-password"===t.code&&(this.passwordError=!0)}}}},Ge=(0,r.A)(Ze,[["render",Re],["__scopeId","data-v-2de1d800"]]),Ke=Ge,Be={class:"profile-view"},Oe={class:"profile-content"},We={key:0,class:"profile-island"},Ve={class:"profile-info"},Ye=["src"],et={class:"profile-right"},tt={class:"profile-det"},st={class:"profile-usr"},at={class:"profile-name"},ot={class:"profile-date"},it={key:0},rt={key:0},nt={class:"buttons-row-e"},lt={key:1},ct={class:"profile-description"},ut={key:0,class:"buttons-row"},dt={key:0,class:"blocked-users"},pt={class:"blocked-list-scroll"},ht=["src"],gt={class:"blocked-info"},mt={class:"blocked-name"},kt={class:"blocked-date"},vt=["onClick"],bt={key:1,class:"locations-gallery"},Lt={class:"locations-scroll"},ft=["src"],yt={key:2,class:"profile-loc"},Ct={class:"profile-locations"},wt={class:"locations-scroll"},Dt=["src"];function Ut(e,t,s,i,r,n){const l=(0,o.g2)("Navbar");return(0,o.uX)(),(0,o.CE)("div",Be,[(0,o.bF)(l),(0,o.Lk)("div",Oe,[r.userData?((0,o.uX)(),(0,o.CE)("div",We,[(0,o.Lk)("div",Ve,[(0,o.Lk)("div",{class:"profile-image-wrapper",onClick:t[1]||(t[1]=(...e)=>n.triggerFileInput&&n.triggerFileInput(...e))},[(0,o.Lk)("img",{src:r.userData.profilePicture,alt:"Profile",class:"profile-image"},null,8,Ye),t[8]||(t[8]=(0,o.Lk)("div",{class:"overlay"},[(0,o.Lk)("span",null,"Змінити фото")],-1)),(0,o.Lk)("input",{type:"file",accept:"image/*",ref:"fileInput",onChange:t[0]||(t[0]=(...e)=>n.handleFileChange&&n.handleFileChange(...e)),class:"hidden-file-input"},null,544)]),(0,o.Lk)("div",et,[(0,o.Lk)("div",tt,[(0,o.Lk)("div",st,[(0,o.Lk)("p",at,"@"+(0,d.v_)(r.userData.username),1),(0,o.Lk)("p",ot," Профіль створено "+(0,d.v_)(n.formatDate(r.userData.createdAt)),1)]),"moderator"!==r.userData.role?((0,o.uX)(),(0,o.CE)("div",it,[r.editingDescription?((0,o.uX)(),(0,o.CE)("div",rt,[(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.newDescription=e),class:"profile-description-textarea",rows:"4",placeholder:"Редагувати опис..."},null,512),[[a.Jo,r.newDescription]]),(0,o.Lk)("div",nt,[(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>n.saveDescription&&n.saveDescription(...e)),class:"br"}," Зберегти "),(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>n.cancelEdit&&n.cancelEdit(...e)),class:"br"},"Скасувати")])])):((0,o.uX)(),(0,o.CE)("div",lt,[(0,o.Lk)("p",ct,(0,d.v_)(r.userData.description||"Цей користувач ще не додав опис."),1)]))])):(0,o.Q3)("",!0)]),r.editingDescription?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",ut,["moderator"!==r.userData.role?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[5]||(t[5]=(...e)=>n.editDescription&&n.editDescription(...e)),class:"description-edit br"}," Редагувати опис ")):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>n.logout&&n.logout(...e)),class:"logout br"},"Вийти з профілю"),(0,o.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>n.deleteAccount&&n.deleteAccount(...e)),class:"delete br"}," Видалити профіль ")]))])]),"moderator"==r.userData.role?((0,o.uX)(),(0,o.CE)("div",dt,[t[9]||(t[9]=(0,o.Lk)("p",{class:"blocked-title"},"Заблоковані користувачі",-1)),(0,o.Lk)("div",pt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.blockedUsers,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"blocked-card"},[(0,o.Lk)("img",{src:e.profilePicture,alt:"Blocked Profile",class:"blocked-image"},null,8,ht),(0,o.Lk)("div",gt,[(0,o.Lk)("p",mt,"@"+(0,d.v_)(e.username),1),(0,o.Lk)("p",kt," Профіль заблоковано "+(0,d.v_)(n.formatDate(e.blockedAt)),1)]),(0,o.Lk)("button",{class:"br",onClick:t=>n.unblockUser(e.id)}," Відновити ",8,vt)])))),128))])])):(0,o.Q3)("",!0),"moderator"==r.userData.role?((0,o.uX)(),(0,o.CE)("div",bt,[t[10]||(t[10]=(0,o.Lk)("p",{class:"blocked-title"},"Забраковані світлини",-1)),(0,o.Lk)("div",Lt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.locations,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"location-image-wrapper"},[(0,o.Lk)("img",{src:e.imageUrl,alt:"Location",class:"location-image"},null,8,ft)])))),128))])])):(0,o.Q3)("",!0),"moderator"!==r.userData.role?((0,o.uX)(),(0,o.CE)("div",yt,[(0,o.Lk)("div",Ct,[t[11]||(t[11]=(0,o.Lk)("p",{class:"blocked-title"},"Мої світлини",-1)),(0,o.Lk)("div",wt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.userLocations,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"location-image-wrapper"},[(0,o.Lk)("img",{src:e.imageUrl,alt:"Location",class:"location-image"},null,8,Dt)])))),128))])])])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])])}var Ft=s(904);const It={name:"ProfileView",components:{Navbar:se,Footer:ne},data(){return{userData:null,editingDescription:!1,newDescription:"",blockedUsers:[],locations:[],userLocations:[],userComments:[]}},methods:{async fetchUserData(e){const t=(0,Y.aU)(),s=(0,Y.H9)(t,"users",e),a=await(0,Y.x7)(s);a.exists()?(this.userData={uid:e,...a.data()},this.userLocations=await this.fetchUserLocations(e),"moderator"===this.userData.role&&(this.fetchBlockedUsers(),this.fetchLocations())):console.error("Документ не знайдено!")},async fetchBlockedUsers(){const e=(0,Y.aU)(),t=(0,Y.P)((0,Y.rJ)(e,"users"),(0,Y._M)("status","==","blocked")),s=await(0,Y.GG)(t);this.blockedUsers=s.docs.map((e=>({id:e.id,...e.data()})))},async fetchLocations(){const e=(0,Y.aU)(),t=(0,Y.P)((0,Y.rJ)(e,"locations"),(0,Y._M)("status","==","rejected")),s=await(0,Y.GG)(t);this.locations=s.docs.map((e=>({id:e.id,...e.data()})))},formatDate(e){if(!e)return"невідомо";const t=e.toDate?e.toDate():new Date(e);return t.toLocaleDateString("uk-UA")},editDescription(){this.editingDescription=!0,this.newDescription=this.userData.description||""},async saveDescription(){if(this.newDescription!==this.userData.description){const e=(0,Y.aU)(),t=(0,Y.H9)(e,"users",this.userData.uid);await(0,Y.mZ)(t,{description:this.newDescription}),this.userData.description=this.newDescription}this.editingDescription=!1},cancelEdit(){this.editingDescription=!1,this.newDescription=this.userData.description||""},logout(){const e=(0,V.xI)();(0,V.CI)(e).then((()=>{this.$router.push("/")})).catch((e=>{console.error("Помилка при виході: ",e)}))},async deleteAccount(){const e=(0,V.xI)(),t=(0,Y.aU)();try{await(0,Y.kd)((0,Y.H9)(t,"users",this.userData.uid)),await e.currentUser.delete(),this.$router.push("/")}catch(s){console.error("Помилка при видаленні акаунта: ",s)}},async unblockUser(e){const t=(0,Y.aU)(),s=(0,Y.H9)(t,"users",e);await(0,Y.mZ)(s,{status:"active"}),this.fetchBlockedUsers()},triggerFileInput(){console.log("Клік на зображення"),this.$refs.fileInput.click()},handleFileChange(e){const t=e.target.files[0];if(t){const e=(0,Ft.c7)(),s=(0,Ft.KR)(e,`profile_pictures/${this.userData.uid}`);(0,Ft.D)(s,t).then((e=>{(0,Ft.qk)(e.ref).then((e=>{this.updateProfilePicture(e)}))}))}},async updateProfilePicture(e){const t=(0,Y.aU)(),s=(0,Y.H9)(t,"users",this.userData.uid);await(0,Y.mZ)(s,{profilePicture:e}),this.userData.profilePicture=e},async fetchUserLocations(e){const t=(0,Y.aU)(),s=(0,Y.P)((0,Y.rJ)(t,"locations"),(0,Y._M)("userUid","==",e)),a=await(0,Y.GG)(s);return a.docs.map((e=>({id:e.id,...e.data()})))}},mounted(){const e=(0,V.xI)();(0,V.hg)(e,(e=>{e?this.fetchUserData(e.uid):this.$router.push("/")}))}},Et=(0,r.A)(It,[["render",Ut],["__scopeId","data-v-0b954b4d"]]),xt=Et,_t={class:"create"},Xt={class:"island-create"},Pt={class:"b-c"},Qt={class:"l-c"},Mt={key:0,class:"suggestions"},At=["onClick"],$t={ref:"mapContainer",class:"location-map"},jt={class:"b-c"},St={class:"l-c"},Nt={class:"b-c-det"},Jt={class:"location-buttons"};function Ht(e,t,s,i,r,n){const l=(0,o.g2)("Navbar"),c=(0,o.g2)("Footer");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(l),(0,o.Lk)("div",_t,[(0,o.Lk)("div",Xt,[t[19]||(t[19]=(0,o.Lk)("p",{class:"location-title"},"Створення локації",-1)),(0,o.Lk)("div",Pt,[(0,o.Lk)("div",Qt,[t[15]||(t[15]=(0,o.Lk)("p",{class:"p-t"},"Додайте локацію",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchQuery=e),onInput:t[1]||(t[1]=(...e)=>n.fetchSuggestions&&n.fetchSuggestions(...e)),onKeydown:[t[2]||(t[2]=(0,a.jR)((e=>n.highlightSuggestion(1)),["down"])),t[3]||(t[3]=(0,a.jR)((e=>n.highlightSuggestion(-1)),["up"])),t[4]||(t[4]=(0,a.jR)(((...e)=>n.selectHighlighted&&n.selectHighlighted(...e)),["enter"]))],type:"text",placeholder:"Введіть адресу",class:"address-input"},null,544),[[a.Jo,r.searchQuery]]),r.suggestions.length?((0,o.uX)(),(0,o.CE)("ul",Mt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.suggestions,((e,t)=>((0,o.uX)(),(0,o.CE)("li",{key:t,class:(0,d.C4)({active:t===r.highlighted}),onClick:t=>n.selectSuggestion(e)},(0,d.v_)(e.place_name),11,At)))),128))])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",$t,null,512)]),(0,o.Lk)("div",jt,[(0,o.Lk)("div",St,[t[16]||(t[16]=(0,o.Lk)("p",{class:"p-t"},"Додайте зображення",-1)),(0,o.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>n.uploadImage&&n.uploadImage(...e)),class:"c-button"},"Додати фото"),(0,o.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>n.removeImage&&n.removeImage(...e)),class:"c-button"},"Видалити фото")]),r.imageUrl?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"image-preview",style:(0,d.Tr)({backgroundImage:`url(${r.imageUrl})`})},null,4)):((0,o.uX)(),(0,o.CE)("div",{key:1,class:"image-upload-area",onDrop:t[7]||(t[7]=(0,a.D$)(((...t)=>e.onDrop&&e.onDrop(...t)),["prevent"])),onDragover:t[8]||(t[8]=(0,a.D$)((()=>{}),["prevent"])),onDragstart:t[9]||(t[9]=(...e)=>n.startDrag&&n.startDrag(...e)),onDragend:t[10]||(t[10]=(...e)=>n.endDrag&&n.endDrag(...e)),style:(0,d.Tr)(r.dragStyle),draggable:"true"},t[17]||(t[17]=[(0,o.Lk)("span",null,"Перетягніть фото сюди",-1)]),36))]),(0,o.Lk)("div",Nt,[t[18]||(t[18]=(0,o.Lk)("p",{class:"p-t"},"Створіть опис",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>r.locationName=e),type:"text",placeholder:"Введіть назву",class:"det-inp",required:""},null,512),[[a.Jo,r.locationName]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>r.locationDescription=e),type:"text",placeholder:"Введіть опис",class:"det-inp"},null,512),[[a.Jo,r.locationDescription]])]),(0,o.Lk)("div",Jt,[(0,o.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>n.saveLocation&&n.saveLocation(...e)),class:"c-button b"},"Зберегти"),(0,o.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>n.cancel&&n.cancel(...e)),class:"c-button b"},"Скасувати")])])]),(0,o.bF)(c)],64)}ce().accessToken="pk.eyJ1IjoibHZxMWljZW1hbiIsImEiOiJjbHU4ZmtuZ2MwYzRvMm9yeGQzZnBycjBkIn0.u4QC3601L2OcFCzw8kzvmw";const zt={name:"CreateLocation",components:{Navbar:se,Footer:ne},data(){return{map:null,marker:null,searchQuery:"",suggestions:[],highlighted:-1,imageUrl:"",locationName:"",locationDescription:"",isDragging:!1,dragStyle:{},locationCoords:null,imageFile:null}},methods:{async fetchSuggestions(){if(!this.searchQuery)return void(this.suggestions=[]);const e=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(this.searchQuery)}.json?access_token=${ce().accessToken}&autocomplete=true&limit=5`),t=await e.json();this.suggestions=t.features},selectSuggestion(e){this.searchQuery=e.place_name,this.suggestions=[];const[t,s]=e.center;this.setMarker(t,s)},highlightSuggestion(e){const t=this.suggestions.length-1;t<0||(this.highlighted+=e,this.highlighted<0&&(this.highlighted=t),this.highlighted>t&&(this.highlighted=0))},selectHighlighted(){this.highlighted>=0&&this.highlighted<this.suggestions.length&&this.selectSuggestion(this.suggestions[this.highlighted])},setMarker(e,t){this.map&&(this.map.flyTo({center:[e,t],zoom:14}),this.marker?this.marker.setLngLat([e,t]):(this.marker=new(ce().Marker)({color:"red",draggable:!0}).setLngLat([e,t]).addTo(this.map),this.marker.on("dragend",this.reverseGeocodeMarker)),this.reverseGeocodeMarker(),this.locationCoords={lng:e,lat:t})},async reverseGeocodeMarker(){const e=this.marker.getLngLat(),t=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e.lng},${e.lat}.json?access_token=${ce().accessToken}`),s=await t.json();s.features[0]&&(this.searchQuery=s.features[0].place_name)},uploadImage(){const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{if(this.imageFile=e.target.files[0],this.imageFile){const e=new FileReader;e.onload=e=>{this.imageUrl=e.target.result},e.readAsDataURL(this.imageFile)}},e.click()},removeImage(){this.imageFile=null,this.imageUrl=""},startDrag(){this.isDragging=!0,this.dragStyle={cursor:"grabbing",opacity:.7}},endDrag(){this.isDragging=!1,this.dragStyle={}},async saveLocation(){if(!this.locationName||!this.searchQuery||!this.imageFile||!this.locationCoords)return void alert("Будь ласка, заповніть всі обов'язкові поля!");const e=(0,Ft.c7)(),t=(0,Ft.KR)(e,`locations/${Date.now()}_${this.imageFile.name}`);try{const e=await(0,Ft.D)(t,this.imageFile),s=await(0,Ft.qk)(e.ref),a=(0,Y.aU)(),o=(0,V.xI)(),i=o.currentUser;let r="Без імені";const n=(0,Y.H9)(a,"users",i.uid),l=await(0,Y.x7)(n);l.exists()&&(r=l.data().username||r);const c=(0,Y.rJ)(a,"locations");await(0,Y.gS)(c,{name:this.locationName,description:this.locationDescription,address:this.searchQuery,coordinates:this.locationCoords,userUid:i.uid,username:r,imageUrl:s,status:"pending",createdAt:Y.Dc.fromDate(new Date)}),alert("Локацію успішно додано!"),this.clearForm()}catch(s){console.error("Error saving location:",s),alert("Сталася помилка при збереженні локації.")}},clearForm(){this.searchQuery="",this.locationName="",this.locationDescription="",this.imageFile=null,this.imageUrl="",this.locationCoords=null},cancel(){this.$router.push("/home")}},mounted(){this.map=new(ce().Map)({container:this.$refs.mapContainer,center:[24.0315,49.8397],zoom:10,style:"mapbox://styles/lvq1iceman/cm9ootxch009b01qs40wa1c8q"}),this.map.on("load",(()=>{this.map.resize()})),this.map.on("click",(e=>{this.setMarker(e.lngLat.lng,e.lngLat.lat)}))}},qt=(0,r.A)(zt,[["render",Ht],["__scopeId","data-v-a6f2de06"]]),Tt=qt,Rt={class:"approve-container"},Zt={class:"approve-card-title"},Gt={class:"approve-card-header"},Kt={class:"approve-card-header-l"},Bt=["src"],Ot=["onClick"],Wt=["onClick"],Vt=["src"],Yt={class:"approve-card-footer"},es={class:"approve-card-street"},ts={class:"approve-card-description"};function ss(e,t,s,a,i,r){const n=(0,o.g2)("Navbar"),l=(0,o.g2)("Footer");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(n),(0,o.Lk)("div",Rt,[t[1]||(t[1]=(0,o.Lk)("p",{class:"approve-title"},"Заявки на публікацію",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.requests,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"approve-card"},[(0,o.Lk)("p",Zt," Користувач @"+(0,d.v_)(e.username)+" бажає опублікувати: ",1),(0,o.Lk)("div",Gt,[(0,o.Lk)("div",Kt,[(0,o.Lk)("img",{class:"profile-photo",src:e.profilePicture,alt:"profile"},null,8,Bt),(0,o.Lk)("button",{class:"approve",onClick:t=>r.approveRequest(e.id)}," Схвалити ",8,Ot),(0,o.Lk)("button",{class:"reject",onClick:t=>r.rejectRequest(e.id)}," Відхилити ",8,Wt)]),(0,o.Lk)("img",{class:"approve-card-header-r",src:e.imageUrl,alt:"location"},null,8,Vt)]),(0,o.Lk)("div",Yt,[(0,o.Lk)("p",es,(0,d.v_)(e.address),1),t[0]||(t[0]=(0,o.Lk)("hr",null,null,-1)),(0,o.Lk)("p",ts,(0,d.v_)(e.description),1)])])))),128))]),(0,o.bF)(l)],64)}const as={name:"Approve",components:{Navbar:se,Footer:ne},data(){return{requests:[]}},async mounted(){const e=(0,Y.aU)(),t=(0,Y.P)((0,Y.rJ)(e,"locations"),(0,Y._M)("status","==","pending")),s=await(0,Y.GG)(t),a=await Promise.all(s.docs.map((async t=>{const s=t.data(),a=s.userUid;let o="/default-avatar.png";if(a){const t=(0,Y.H9)(e,"users",a),s=await(0,Y.x7)(t);s.exists()&&(o=s.data().profilePicture||o)}return{id:t.id,...s,profilePicture:o}})));this.requests=a},methods:{async getUserPhotoByUsername(e){const t=(0,Y.aU)(),s=(0,Y.rJ)(t,"users"),a=(0,Y.P)(s,(0,Y._M)("username","==",e)),o=await(0,Y.GG)(a);if(!o.empty){const e=o.docs[0];return e.data().photoURL||null}return null},async approveRequest(e){const t=(0,Y.aU)();await(0,Y.mZ)((0,Y.H9)(t,"locations",e),{status:"approved"}),this.requests=this.requests.filter((t=>t.id!==e))},async rejectRequest(e){const t=(0,Y.aU)();await(0,Y.mZ)((0,Y.H9)(t,"locations",e),{status:"rejected"}),this.requests=this.requests.filter((t=>t.id!==e))}}},os=(0,r.A)(as,[["render",ss],["__scopeId","data-v-9347bd20"]]),is=os,rs={class:"publications"},ns={class:"publication-grid"},ls=["onMouseenter","onMouseleave"],cs=["src"],us={class:"publication-address-mobile"},ds=["onClick"];function ps(e,t,s,a,i,r){const n=(0,o.g2)("Navbar"),l=(0,o.g2)("router-link"),c=(0,o.g2)("Footer");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(n),(0,o.Lk)("div",rs,[t[2]||(t[2]=(0,o.Lk)("p",{class:"publication-title"},"Мої публікації",-1)),(0,o.Lk)("div",ns,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.publications,(e=>((0,o.uX)(),(0,o.CE)("div",{class:"publication-card",key:e.id,onMouseenter:t=>e.showActions=!0,onMouseleave:t=>e.showActions=!1},[(0,o.Lk)("img",{src:e.imageUrl,alt:"Publication Image",class:"publication-image"},null,8,cs),(0,o.Lk)("div",{class:(0,d.C4)(["action-container",{"show-actions":e.showActions}])},[(0,o.Lk)("p",us,(0,d.v_)(e.address),1),(0,o.bF)(l,{to:"/edit-location/"+e.id,class:"action"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.eW)("Редагувати")]))),_:2},1032,["to"]),t[1]||(t[1]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("button",{class:"action",onClick:t=>r.deletePublication(e.id)}," Видалити ",8,ds)],2)],40,ls)))),128))])]),(0,o.bF)(c)],64)}const hs={name:"MyPublications",components:{Navbar:se,Footer:ne},data(){return{publications:[],userUid:"",isMounted:!1}},methods:{async deletePublication(e){const t=(0,Y.aU)(),s=(0,Y.H9)(t,"locations",e);await(0,Y.kd)(s),this.publications=this.publications.filter((t=>t.id!==e))},editPublication(e){}},async mounted(){const e=(0,V.xI)(),t=(0,Y.aU)();this.userUid=e.currentUser.uid,this.isMounted=!0;const s=(0,Y.P)((0,Y.rJ)(t,"locations"),(0,Y._M)("userUid","==",this.userUid),(0,Y._M)("status","==","approved")),a=await(0,Y.GG)(s);this.isMounted&&(this.publications=a.docs.map((e=>({id:e.id,...e.data(),showActions:!1}))))},onBeforeUnmount(){this.isMounted=!1}},gs=(0,r.A)(hs,[["render",ps],["__scopeId","data-v-6d7e6fef"]]),ms=gs,ks={class:"create"},vs={class:"island-create"},bs={class:"b-c"},Ls={class:"l-c"},fs={key:0,class:"suggestions"},ys=["onClick"],Cs={ref:"mapContainer",class:"location-map"},ws={class:"b-c"},Ds={class:"l-c"},Us={class:"b-c-det"},Fs={class:"location-buttons"};function Is(e,t,s,i,r,n){const l=(0,o.g2)("Navbar"),c=(0,o.g2)("Footer");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(l),(0,o.Lk)("div",ks,[(0,o.Lk)("div",vs,[t[19]||(t[19]=(0,o.Lk)("p",{class:"location-title"},"Редагування локації",-1)),(0,o.Lk)("div",bs,[(0,o.Lk)("div",Ls,[t[15]||(t[15]=(0,o.Lk)("p",{class:"p-t"},"Додайте локацію",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchQuery=e),onInput:t[1]||(t[1]=(...e)=>n.fetchSuggestions&&n.fetchSuggestions(...e)),onKeydown:[t[2]||(t[2]=(0,a.jR)((e=>n.highlightSuggestion(1)),["down"])),t[3]||(t[3]=(0,a.jR)((e=>n.highlightSuggestion(-1)),["up"])),t[4]||(t[4]=(0,a.jR)(((...e)=>n.selectHighlighted&&n.selectHighlighted(...e)),["enter"]))],type:"text",placeholder:"Введіть адресу",class:"address-input"},null,544),[[a.Jo,r.searchQuery]]),r.suggestions.length?((0,o.uX)(),(0,o.CE)("ul",fs,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.suggestions,((e,t)=>((0,o.uX)(),(0,o.CE)("li",{key:t,class:(0,d.C4)({active:t===r.highlighted}),onClick:t=>n.selectSuggestion(e)},(0,d.v_)(e.place_name),11,ys)))),128))])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",Cs,null,512)]),(0,o.Lk)("div",ws,[(0,o.Lk)("div",Ds,[t[16]||(t[16]=(0,o.Lk)("p",{class:"p-t"},"Додайте зображення",-1)),(0,o.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>n.uploadImage&&n.uploadImage(...e)),class:"c-button"},"Змінити фото"),(0,o.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>n.removeImage&&n.removeImage(...e)),class:"c-button"},"Видалити фото")]),r.imageUrl?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"image-preview",style:(0,d.Tr)({backgroundImage:`url(${r.imageUrl})`})},null,4)):((0,o.uX)(),(0,o.CE)("div",{key:1,class:"image-upload-area",onDrop:t[7]||(t[7]=(0,a.D$)(((...t)=>e.onDrop&&e.onDrop(...t)),["prevent"])),onDragover:t[8]||(t[8]=(0,a.D$)((()=>{}),["prevent"])),onDragstart:t[9]||(t[9]=(...e)=>n.startDrag&&n.startDrag(...e)),onDragend:t[10]||(t[10]=(...e)=>n.endDrag&&n.endDrag(...e)),style:(0,d.Tr)(r.dragStyle),draggable:"true"},t[17]||(t[17]=[(0,o.Lk)("span",null,"Перетягніть фото сюди",-1)]),36))]),(0,o.Lk)("div",Us,[t[18]||(t[18]=(0,o.Lk)("p",{class:"p-t"},"Створіть опис",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>r.locationName=e),type:"text",placeholder:"Введіть назву",class:"det-inp",required:""},null,512),[[a.Jo,r.locationName]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>r.locationDescription=e),type:"text",placeholder:"Введіть опис",class:"det-inp"},null,512),[[a.Jo,r.locationDescription]])]),(0,o.Lk)("div",Fs,[(0,o.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>n.saveLocation&&n.saveLocation(...e)),class:"c-button b"},"Зберегти"),(0,o.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>n.cancel&&n.cancel(...e)),class:"c-button b"},"Скасувати")])])]),(0,o.bF)(c)],64)}ce().accessToken="pk.eyJ1IjoibHZxMWljZW1hbiIsImEiOiJjbHU4ZmtuZ2MwYzRvMm9yeGQzZnBycjBkIn0.u4QC3601L2OcFCzw8kzvmw";const Es={name:"EditLocation",components:{Navbar:se,Footer:ne},data(){return{map:null,marker:null,searchQuery:"",suggestions:[],highlighted:-1,imageUrl:"",locationName:"",locationDescription:"",isDragging:!1,dragStyle:{},locationCoords:null,imageFile:null,locationId:""}},methods:{async fetchSuggestions(){if(!this.searchQuery)return void(this.suggestions=[]);const e=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(this.searchQuery)}.json?access_token=${ce().accessToken}&autocomplete=true&limit=5`),t=await e.json();this.suggestions=t.features},selectSuggestion(e){this.searchQuery=e.place_name,this.suggestions=[];const[t,s]=e.center;this.setMarker(t,s)},highlightSuggestion(e){const t=this.suggestions.length-1;t<0||(this.highlighted+=e,this.highlighted<0&&(this.highlighted=t),this.highlighted>t&&(this.highlighted=0))},selectHighlighted(){this.highlighted>=0&&this.highlighted<this.suggestions.length&&this.selectSuggestion(this.suggestions[this.highlighted])},setMarker(e,t){this.map&&(this.map.flyTo({center:[e,t],zoom:14}),this.marker?this.marker.setLngLat([e,t]):(this.marker=new(ce().Marker)({color:"red",draggable:!0}).setLngLat([e,t]).addTo(this.map),this.marker.on("dragend",this.reverseGeocodeMarker)),this.reverseGeocodeMarker(),this.locationCoords={lng:e,lat:t})},async reverseGeocodeMarker(){const e=this.marker.getLngLat(),t=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e.lng},${e.lat}.json?access_token=${ce().accessToken}`),s=await t.json();s.features[0]&&(this.searchQuery=s.features[0].place_name)},uploadImage(){const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{if(this.imageFile=e.target.files[0],this.imageFile){const e=new FileReader;e.onload=e=>{this.imageUrl=e.target.result},e.readAsDataURL(this.imageFile)}},e.click()},removeImage(){this.imageFile=null,this.imageUrl=""},startDrag(){this.isDragging=!0,this.dragStyle={cursor:"grabbing",opacity:.7}},endDrag(){this.isDragging=!1,this.dragStyle={}},async loadLocationData(){const e=(0,Y.aU)(),t=(0,Y.H9)(e,"locations",this.$route.params.id),s=await(0,Y.x7)(t);if(s.exists()){const e=s.data();this.locationId=s.id,this.locationName=e.name,this.locationDescription=e.description,this.searchQuery=e.address,this.locationCoords=e.coordinates,this.imageUrl=e.imageUrl,this.setMarker(e.coordinates.lng,e.coordinates.lat)}},async saveLocation(){if(!this.locationName||!this.searchQuery||!this.locationCoords)return void alert("Будь ласка, заповніть всі обов'язкові поля!");let e=this.imageUrl;if(this.imageFile){const t=(0,Ft.c7)(),s=(0,Ft.KR)(t,`locations/${Date.now()}_${this.imageFile.name}`);try{const t=await(0,Ft.D)(s,this.imageFile);e=await(0,Ft.qk)(t.ref)}catch(l){return console.error("Error uploading image:",l),void alert("Сталася помилка при завантаженні фото.")}}const t=(0,Y.aU)(),s=(0,V.xI)(),a=s.currentUser;let o="Без імені";const i=(0,Y.H9)(t,"users",a.uid),r=await(0,Y.x7)(i);r.exists()&&(o=r.data().username||o);const n=(0,Y.H9)(t,"locations",this.locationId);try{await(0,Y.mZ)(n,{name:this.locationName,description:this.locationDescription,address:this.searchQuery,coordinates:this.locationCoords,userUid:a.uid,username:o,imageUrl:e,status:"pending",updatedAt:Y.Dc.fromDate(new Date)}),alert("Локацію успішно оновлено!"),this.$router.push("/my-publications")}catch(l){console.error("Error saving location:",l),alert("Сталася помилка при збереженні локації.")}},cancel(){this.$router.push("/my-publications")}},mounted(){this.loadLocationData(),this.map=new(ce().Map)({container:this.$refs.mapContainer,style:"mapbox://styles/mapbox/streets-v11",center:[25,49],zoom:8})}},xs=(0,r.A)(Es,[["render",Is],["__scopeId","data-v-280151d0"]]),_s=xs,Xs=[{path:"/",name:"start",component:Fe},{path:"/home",name:"home",component:pe},{path:"/login",name:"login",component:$e},{path:"/registration",name:"registration",component:Ke},{path:"/profile",name:"profile",component:xt,meta:{requiresAuth:!0}},{path:"/create-location",name:"create-location",component:Tt,meta:{requiresAuth:!0}},{path:"/approve",name:"approve",component:is,meta:{requiresAuth:!0}},{path:"/my-publications",name:"my-publications",component:ms,meta:{requiresAuth:!0}},{path:"/edit-location/:id",name:"edit-location",component:_s,meta:{requiresAuth:!0},props:!0}],Ps=(0,u.aE)({history:(0,u.LA)("/"),routes:Xs}),Qs=()=>new Promise(((e,t)=>{const s=(0,V.hg)((0,V.xI)(),(t=>{s(),e(t)}),t)}));Ps.beforeEach((async(e,t,s)=>{e.matched.some((e=>e.meta.requiresAuth))?await Qs()?s():(console.log("You are not logged in"),s("/login")):s()}));const Ms=Ps;var As=s(223);(0,a.Ef)(c).use(Ms).mount("#app");const $s={apiKey:"AIzaSyA_e0D4JlvkLdZvTE3PA7hy0W15wTXuMxI",authDomain:"kursova-5374b.firebaseapp.com",databaseURL:"https://kursova-5374b-default-rtdb.europe-west1.firebasedatabase.app",projectId:"kursova-5374b",storageBucket:"kursova-5374b.appspot.com",messagingSenderId:"444568413958",appId:"1:444568413958:web:e4258c7fa4134d96fee087"},js=(0,As.Wp)($s);(0,Y.aU)(js),(0,Ft.c7)(js)}},t={};function s(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,s),i.exports}s.m=e,(()=>{var e=[];s.O=(t,a,o,i)=>{if(!a){var r=1/0;for(u=0;u<e.length;u++){for(var[a,o,i]=e[u],n=!0,l=0;l<a.length;l++)(!1&i||r>=i)&&Object.keys(s.O).every((e=>s.O[e](a[l])))?a.splice(l--,1):(n=!1,i<r&&(r=i));if(n){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[a,o,i]}})(),(()=>{s.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return s.d(t,{a:t}),t}})(),(()=>{s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{s.p="/"})(),(()=>{var e={524:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var o,i,[r,n,l]=a,c=0;if(r.some((t=>0!==e[t]))){for(o in n)s.o(n,o)&&(s.m[o]=n[o]);if(l)var u=l(s)}for(t&&t(a);c<r.length;c++)i=r[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(u)},a=self["webpackChunkdiploma_bach"]=self["webpackChunkdiploma_bach"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=s.O(void 0,[504],(()=>s(443)));a=s.O(a)})();
//# sourceMappingURL=app.e6ae2f27.js.map