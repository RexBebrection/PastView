(()=>{"use strict";var e={330:(e,t,a)=>{var s=a(751),i=a(641);function o(e,t){const a=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)(i.FK,null,[t[0]||(t[0]=(0,i.Lk)("nav",null,null,-1)),(0,i.bF)(a)],64)}var r=a(262);const n={},l=(0,r.A)(n,[["render",o]]),c=l;var u=a(220),d=a(33);const p={class:"home"},h={class:"home-content"},g={class:"home-info-container"},m={class:"map-border"},k={ref:"mapContainer",class:"map"},v={class:"home-info-list"},b={class:"search-bar"},f=["onClick"],L={class:"street-name"},y={class:"profile-info"},w=["src"],C={class:"profile-name"};function D(e,t,a,o,r,n){const l=(0,i.g2)("Navbar");return(0,i.uX)(),(0,i.CE)("div",p,[(0,i.bF)(l),(0,i.Lk)("div",h,[t[1]||(t[1]=(0,i.Lk)("p",{class:"home-title"},"Інтерактивна ретро-карта міста Львів",-1)),(0,i.Lk)("div",g,[(0,i.Lk)("div",m,[(0,i.Lk)("div",k,null,512)]),(0,i.Lk)("div",v,[(0,i.Lk)("div",b,[(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.searchQuery=e),placeholder:"Пошук..."},null,512),[[s.Jo,r.searchQuery]])]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.filteredItems,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{class:"home-info-item",key:t,onClick:t=>n.focusOnLocation(e)},[(0,i.Lk)("div",L,(0,d.v_)(e.street),1),(0,i.Lk)("div",y,[(0,i.Lk)("img",{src:e.profileImage,alt:"Profile",class:"profile-image"},null,8,w),(0,i.Lk)("p",C,(0,d.v_)(e.username),1)])],8,f)))),128))])])])])}const E=a.p+"img/Logo(big).03776db6.png",U={class:"navbar"},I={class:"navbar-brand"},_={class:"navbar-menu"},F={key:0,class:"navbar-start"},x={key:3,href:"mailto:someone@example.com",class:"navbar-item",id:"link"},X={class:"navbar-profile"},Q={class:"profile-pic-wrapper"},M=["src"],j={class:"navbar-profile-email"};function A(e,t,a,s,o,r){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("nav",null,[(0,i.Lk)("div",U,[(0,i.Lk)("div",I,[(0,i.bF)(n,{to:"/home",class:"navbar-item"},{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.Lk)("img",{src:E,alt:"Logo"},null,-1)]))),_:1})]),(0,i.Lk)("div",_,[o.user?((0,i.uX)(),(0,i.CE)("div",F,[(0,i.bF)(n,{to:"/home",class:"navbar-item",id:"link"},{default:(0,i.k6)((()=>t[1]||(t[1]=[(0,i.eW)("Головна")]))),_:1}),"moderator"!==o.user.role?((0,i.uX)(),(0,i.Wv)(n,{key:0,to:"/create-location",class:"navbar-item",id:"link"},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)("Додати локацію")]))),_:1})):(0,i.Q3)("",!0),"moderator"!==o.user.role?((0,i.uX)(),(0,i.Wv)(n,{key:1,to:"/my-publications",class:"navbar-item",id:"link"},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)(" Мої публікації ")]))),_:1})):(0,i.Q3)("",!0),"moderator"==o.user.role?((0,i.uX)(),(0,i.Wv)(n,{key:2,to:"/approve",class:"navbar-item",id:"link"},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)(" Підтвердження ")]))),_:1})):(0,i.Q3)("",!0),"moderator"!==o.user.role?((0,i.uX)(),(0,i.CE)("a",x," Написати відгук ")):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",X,[o.user?((0,i.uX)(),(0,i.Wv)(n,{key:0,to:"/profile",class:"navbar-profile-link",id:"link"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",Q,[(0,i.Lk)("img",{src:o.user.profilePicture,alt:"Profile"},null,8,M)]),(0,i.Lk)("p",j,(0,d.v_)(o.user.email),1)])),_:1})):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.bF)(n,{to:"/login",class:"navbar-item",id:"link"},{default:(0,i.k6)((()=>t[5]||(t[5]=[(0,i.eW)("Увійти")]))),_:1}),(0,i.bF)(n,{to:"/registration",class:"navbar-item",id:"link"},{default:(0,i.k6)((()=>t[6]||(t[6]=[(0,i.eW)("Зареєструватись")]))),_:1})],64))])])])}var P=a(783),$=a(884);const S={data(){return{user:null}},created(){const e=(0,P.xI)();e.onAuthStateChanged((async e=>{e?(this.user=e,await this.fetchUserData(e.uid)):this.user=null}))},methods:{async fetchUserData(e){const t=(0,$.aU)(),a=(0,$.H9)(t,"users",e),s=await(0,$.x7)(a);s.exists()?this.user={...this.user,...s.data()}:console.log("User not found in Firestore")},async logout(){try{await signOut((0,P.xI)()),this.$router.push("/")}catch(e){console.error("Logout error",e)}}}},H=(0,r.A)(S,[["render",A],["__scopeId","data-v-91ab3b2c"]]),N=H;var q=a(842),z=a.n(q);const J={components:{Navbar:N},data(){return{searchQuery:"",locations:[],map:null}},computed:{filteredItems(){return this.locations.filter((e=>e.street.toLowerCase().includes(this.searchQuery.toLowerCase())))}},methods:{async fetchLocations(){const e=(0,$.aU)(),t=(0,$.P)((0,$.rJ)(e,"locations"),(0,$._M)("status","==","approved")),a=await(0,$.GG)(t),s=await Promise.all(a.docs.map((async t=>{const a=t.data(),s=a.coordinates;if(!s||isNaN(s.lat)||isNaN(s.lng))return console.error(`Некоректні координати для локації ${t.id}`),null;const i=a.userUid,o=(0,$.H9)(e,"users",i),r=await(0,$.x7)(o);let n="/default-avatar.png",l="Unknown";if(r.exists()){const e=r.data();n=e.profilePicture||n,l=e.username||l}return{id:t.id,street:a.address,profileImage:n,username:l,coordinates:[s.lng,s.lat],locationImage:a.image||"/default-location.jpg"}})));this.locations=s.filter((e=>null!==e)),this.locations.forEach((e=>{(new(z().Marker)).setLngLat(e.coordinates).setPopup((new(z().Popup)).setHTML(`\n              <img src="${e.locationImage}" alt="Location Photo" style="width: 100%; height: auto;">\n            `)).addTo(this.map)}))},focusOnLocation(e){const{coordinates:t}=e;this.map.flyTo({center:t,zoom:15})}},mounted(){z().accessToken="pk.eyJ1IjoibHZxMWljZW1hbiIsImEiOiJjbHU4ZmtuZ2MwYzRvMm9yeGQzZnBycjBkIn0.u4QC3601L2OcFCzw8kzvmw",this.map=new(z().Map)({container:this.$refs.mapContainer,style:"mapbox://styles/lvq1iceman/cm9ootxch009b01qs40wa1c8q",center:[24.0315,49.8397],zoom:13}),window.addEventListener("resize",(()=>{this.map&&this.map.resize()})),this.fetchLocations()}},R=(0,r.A)(J,[["render",D],["__scopeId","data-v-469e4f59"]]),Z=R,K={class:"start"},T={class:"island"},W={class:"island-buttons"};function B(e,t,a,s,o,r){const n=(0,i.g2)("BackgroundSlider"),l=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",K,[(0,i.bF)(n),(0,i.Lk)("div",T,[t[3]||(t[3]=(0,i.Lk)("div",{class:"island-border"},[(0,i.Lk)("img",{src:E,alt:"Island",class:"island-image"}),(0,i.Lk)("p",{class:"island-text"}," Ласкаво просимо до Past View — унікального сервісу, що переносить вас у минуле міста. Натискайте на точки на карті, щоб побачити старовинні фотографії та дізнатися історії цих місць. Зареєструйтеся, щоб додавати власні знімки, коментувати й ділитися своїми враженнями. Відчуйте історію міста по-новому! ")],-1)),(0,i.Lk)("div",W,[(0,i.bF)(l,{to:"/home",class:"button-i"},{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.eW)("Почати")]))),_:1}),(0,i.bF)(l,{to:"/login",class:"button-i"},{default:(0,i.k6)((()=>t[1]||(t[1]=[(0,i.eW)("Увійти")]))),_:1}),(0,i.bF)(l,{to:"/registration",class:"button-i"},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)("Зареєструватись")]))),_:1})])])])}const G={class:"background-slider"},O={class:"gallery"},V=["src"];function Y(e,t,a,s,o,r){return(0,i.uX)(),(0,i.CE)("div",G,[(0,i.Lk)("div",O,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.images,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{class:(0,d.C4)(["gallery-item",{active:t===o.currentIndex}]),key:t},[(0,i.Lk)("img",{src:e,alt:"gallery-image"},null,8,V)],2)))),128))])])}const ee={name:"BackgroundSlider",data(){return{currentIndex:0,images:["https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2Fbackground%2Flviv-zgori.png?alt=media&token=8560ad72-e2e9-4930-a069-3113a37b9455","https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2Fbackground%2Fdvometrovi-stiny-snigu-na-vul.-stryjskij.-foto-1920-1930-h-rr.%202.png?alt=media&token=085ed21c-1c34-4afb-a181-b89149a4409c","https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2Fbackground%2Fpelchinskiy-stav-i-tsitadel-u-1893-rotsi.png?alt=media&token=6da1184d-113b-41d1-b0fc-9203cbd9cd44","https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2Fbackground%2Ftramvay-12-yide-vniz-po-vul.-krivonosa.png?alt=media&token=f3ffc1b1-686c-406c-8c65-c60b1897aa1d"]}},mounted(){setInterval((()=>{this.currentIndex=(this.currentIndex+1)%this.images.length}),6e3)}},te=(0,r.A)(ee,[["render",Y],["__scopeId","data-v-48cad606"]]),ae=te,se={components:{BackgroundSlider:ae}},ie=(0,r.A)(se,[["render",B],["__scopeId","data-v-38f70244"]]),oe=ie,re={class:"start"},ne={class:"login-container"},le={class:"login-inputs"},ce={class:"login-buttons"},ue=["onClick"],de={key:0,class:"error-text"};function pe(e,t,a,o,r,n){const l=(0,i.g2)("BackgroundSlider"),c=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",re,[(0,i.bF)(l),(0,i.Lk)("div",ne,[t[5]||(t[5]=(0,i.Lk)("img",{src:E,alt:"Logo",class:"logo-small"},null,-1)),t[6]||(t[6]=(0,i.Lk)("h2",{class:"login-title"},"Вхід",-1)),(0,i.Lk)("div",le,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.email=e),type:"text",placeholder:"Логін",class:(0,d.C4)(["login-input",{"input-error":r.loginError}]),onKeyup:t[1]||(t[1]=(0,s.jR)(((...e)=>n.login&&n.login(...e)),["enter"]))},null,34),[[s.Jo,r.email]]),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.password=e),type:"password",placeholder:"Пароль",class:(0,d.C4)(["login-input",{"input-error":r.loginError}]),onKeyup:t[3]||(t[3]=(0,s.jR)(((...e)=>n.login&&n.login(...e)),["enter"]))},null,34),[[s.Jo,r.password]])]),(0,i.Lk)("div",ce,[(0,i.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>n.login&&n.login(...e)),class:"login-button"},"Увійти"),(0,i.bF)(c,{to:"/",custom:""},{default:(0,i.k6)((({navigate:e})=>[(0,i.Lk)("button",{onClick:e,class:"login-button"},"Скасувати",8,ue)])),_:1})]),r.loginError?((0,i.uX)(),(0,i.CE)("div",de,"Неправильні логін або пароль")):(0,i.Q3)("",!0)])])}const he={components:{BackgroundSlider:ae},data(){return{email:"",password:"",loginError:!1}},methods:{async login(){const e=(0,P.xI)();try{await(0,P.x9)(e,this.email,this.password),console.log("Успішний вхід!"),this.$router.push("/home"),this.loginError=!1}catch(t){console.error("Помилка входу:",t.message),this.loginError=!0}}}},ge=(0,r.A)(he,[["render",pe],["__scopeId","data-v-be9f99c2"]]),me=ge,ke={class:"start"},ve={class:"registation-container"},be={class:"registation-inputs"},fe={key:0,class:"error-text"},Le={key:1,class:"error-text"},ye={key:2,class:"error-text"},we={class:"registation-buttons"},Ce=["onClick"];function De(e,t,a,o,r,n){const l=(0,i.g2)("BackgroundSlider"),c=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",ke,[(0,i.bF)(l),(0,i.Lk)("div",ve,[t[4]||(t[4]=(0,i.Lk)("img",{src:E,alt:"Logo",class:"logo-small"},null,-1)),t[5]||(t[5]=(0,i.Lk)("h2",{class:"registation-title"},"Реєстрація",-1)),(0,i.Lk)("div",be,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.username=e),type:"text",placeholder:"Ім’я користувача",class:(0,d.C4)(["registation-input",{"input-error":r.usernameError}])},null,2),[[s.Jo,r.username]]),r.usernameError?((0,i.uX)(),(0,i.CE)("div",fe,"Ім’я користувача обов’язкове")):(0,i.Q3)("",!0),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.email=e),type:"text",placeholder:"Email",class:(0,d.C4)(["registation-input",{"input-error":r.emailError}])},null,2),[[s.Jo,r.email]]),r.emailError?((0,i.uX)(),(0,i.CE)("div",Le,"Неправильний формат email")):(0,i.Q3)("",!0),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.password=e),type:"password",placeholder:"Пароль",class:(0,d.C4)(["registation-input",{"input-error":r.passwordError}])},null,2),[[s.Jo,r.password]]),r.passwordError?((0,i.uX)(),(0,i.CE)("div",ye," Пароль повинен містити мінімум 6 символів, цифри та букви ")):(0,i.Q3)("",!0)]),(0,i.Lk)("div",we,[(0,i.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>n.register&&n.register(...e)),class:"registation-button"},"Зареєструватись"),(0,i.bF)(c,{to:"/",custom:""},{default:(0,i.k6)((({navigate:e})=>[(0,i.Lk)("button",{onClick:e,class:"registation-button"},"Скасувати",8,Ce)])),_:1})])])])}const Ee={components:{BackgroundSlider:ae},data(){return{username:"",email:"",password:"",usernameError:!1,emailError:!1,passwordError:!1}},methods:{validateEmail(e){const t=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;return t.test(e)},validatePassword(e){const t=/^(?=.*[a-zA-Z])(?=.*\d).{6,}$/;return t.test(e)},async register(){if(this.usernameError=!this.username.trim(),this.emailError=!this.validateEmail(this.email),this.passwordError=!this.validatePassword(this.password),this.usernameError||this.emailError||this.passwordError)return;const e=(0,P.xI)();try{const t=await(0,P.eJ)(e,this.email,this.password),a=t.user,s=(0,$.aU)(),i=(0,$.H9)(s,"users",a.uid);await(0,$.BN)(i,{email:this.email,username:this.username,role:"user",profilePicture:"https://firebasestorage.googleapis.com/v0/b/kursova-5374b.appspot.com/o/bach%2F491004389_596021710156389_1039114513883964411_n.jpg?alt=media&token=63353374-7c0a-4060-b208-1310f3f67bce",createdAt:new Date,uid:a.uid,role:"user",status:"active"}),console.log("Реєстрація та запис в Firestore успішні!"),this.$router.push("/home")}catch(t){console.error("Помилка реєстрації:",t.message),"auth/email-already-in-use"===t.code||"auth/invalid-email"===t.code?this.emailError=!0:"auth/weak-password"===t.code&&(this.passwordError=!0)}}}},Ue=(0,r.A)(Ee,[["render",De],["__scopeId","data-v-659115d4"]]),Ie=Ue,_e={class:"profile-view"},Fe={class:"profile-content"},xe={key:0,class:"profile-island"},Xe={class:"profile-info"},Qe=["src"],Me={class:"profile-right"},je={class:"profile-det"},Ae={class:"profile-usr"},Pe={class:"profile-name"},$e={class:"profile-date"},Se={key:0},He={key:0},Ne={class:"buttons-row-e"},qe={key:1},ze={class:"profile-description"},Je={key:0,class:"buttons-row"},Re={key:0,class:"blocked-users"},Ze={class:"blocked-list-scroll"},Ke=["src"],Te={class:"blocked-info"},We={class:"blocked-name"},Be={class:"blocked-date"},Ge=["onClick"],Oe={key:1,class:"locations-gallery"},Ve={class:"locations-scroll"},Ye=["src"];function et(e,t,a,o,r,n){const l=(0,i.g2)("Navbar");return(0,i.uX)(),(0,i.CE)("div",_e,[(0,i.bF)(l),(0,i.Lk)("div",Fe,[r.userData?((0,i.uX)(),(0,i.CE)("div",xe,[(0,i.Lk)("div",Xe,[(0,i.Lk)("div",{class:"profile-image-wrapper",onClick:t[1]||(t[1]=(...e)=>n.triggerFileInput&&n.triggerFileInput(...e))},[(0,i.Lk)("img",{src:r.userData.profilePicture,alt:"Profile",class:"profile-image"},null,8,Qe),t[8]||(t[8]=(0,i.Lk)("div",{class:"overlay"},[(0,i.Lk)("span",null,"Змінити фото")],-1)),(0,i.Lk)("input",{type:"file",accept:"image/*",ref:"fileInput",onChange:t[0]||(t[0]=(...e)=>n.handleFileChange&&n.handleFileChange(...e)),class:"hidden-file-input"},null,544)]),(0,i.Lk)("div",Me,[(0,i.Lk)("div",je,[(0,i.Lk)("div",Ae,[(0,i.Lk)("p",Pe,"@"+(0,d.v_)(r.userData.username),1),(0,i.Lk)("p",$e," Профіль створено "+(0,d.v_)(n.formatDate(r.userData.createdAt)),1)]),"moderator"!==r.userData.role?((0,i.uX)(),(0,i.CE)("div",Se,[r.editingDescription?((0,i.uX)(),(0,i.CE)("div",He,[(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.newDescription=e),class:"profile-description-textarea",rows:"4",placeholder:"Редагувати опис..."},null,512),[[s.Jo,r.newDescription]]),(0,i.Lk)("div",Ne,[(0,i.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>n.saveDescription&&n.saveDescription(...e)),class:"br"}," Зберегти "),(0,i.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>n.cancelEdit&&n.cancelEdit(...e)),class:"br"},"Скасувати")])])):((0,i.uX)(),(0,i.CE)("div",qe,[(0,i.Lk)("p",ze,(0,d.v_)(r.userData.description||"Цей користувач ще не додав опис."),1)]))])):(0,i.Q3)("",!0)]),r.editingDescription?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",Je,["moderator"!==r.userData.role?((0,i.uX)(),(0,i.CE)("button",{key:0,onClick:t[5]||(t[5]=(...e)=>n.editDescription&&n.editDescription(...e)),class:"description-edit br"}," Редагувати опис ")):(0,i.Q3)("",!0),(0,i.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>n.logout&&n.logout(...e)),class:"logout br"},"Вийти з профілю"),(0,i.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>n.deleteAccount&&n.deleteAccount(...e)),class:"delete br"}," Видалити профіль ")]))])]),"moderator"==r.userData.role?((0,i.uX)(),(0,i.CE)("div",Re,[t[9]||(t[9]=(0,i.Lk)("p",{class:"blocked-title"},"Заблоковані користувачі",-1)),(0,i.Lk)("div",Ze,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.blockedUsers,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"blocked-card"},[(0,i.Lk)("img",{src:e.profilePicture,alt:"Blocked Profile",class:"blocked-image"},null,8,Ke),(0,i.Lk)("div",Te,[(0,i.Lk)("p",We,"@"+(0,d.v_)(e.username),1),(0,i.Lk)("p",Be," Профіль заблоковано "+(0,d.v_)(n.formatDate(e.blockedAt)),1)]),(0,i.Lk)("button",{class:"br",onClick:t=>n.unblockUser(e.id)}," Відновити ",8,Ge)])))),128))])])):(0,i.Q3)("",!0),"moderator"==r.userData.role?((0,i.uX)(),(0,i.CE)("div",Oe,[t[10]||(t[10]=(0,i.Lk)("p",{class:"blocked-title"},"Забраковані світлини",-1)),(0,i.Lk)("div",Ve,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.locations,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"location-image-wrapper"},[(0,i.Lk)("img",{src:e.imageUrl,alt:"Location",class:"location-image"},null,8,Ye)])))),128))])])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])])}var tt=a(904);const at={name:"ProfileView",components:{Navbar:N},data(){return{userData:null,editingDescription:!1,newDescription:"",blockedUsers:[],locations:[]}},methods:{async fetchUserData(e){const t=(0,$.aU)(),a=(0,$.H9)(t,"users",e),s=await(0,$.x7)(a);s.exists()?(this.userData={uid:e,...s.data()},"moderator"===this.userData.role&&(this.fetchBlockedUsers(),this.fetchLocations())):console.error("Документ не знайдено!")},async fetchBlockedUsers(){const e=(0,$.aU)(),t=(0,$.P)((0,$.rJ)(e,"users"),(0,$._M)("status","==","blocked")),a=await(0,$.GG)(t);this.blockedUsers=a.docs.map((e=>({id:e.id,...e.data()})))},async fetchLocations(){const e=(0,$.aU)(),t=(0,$.P)((0,$.rJ)(e,"locations"),(0,$._M)("status","==","rejected")),a=await(0,$.GG)(t);this.locations=a.docs.map((e=>({id:e.id,...e.data()})))},formatDate(e){if(!e)return"невідомо";const t=e.toDate?e.toDate():new Date(e);return t.toLocaleDateString("uk-UA")},editDescription(){this.editingDescription=!0,this.newDescription=this.userData.description||""},async saveDescription(){if(this.newDescription!==this.userData.description){const e=(0,$.aU)(),t=(0,$.H9)(e,"users",this.userData.uid);await(0,$.mZ)(t,{description:this.newDescription}),this.userData.description=this.newDescription}this.editingDescription=!1},cancelEdit(){this.editingDescription=!1,this.newDescription=this.userData.description||""},logout(){const e=(0,P.xI)();(0,P.CI)(e).then((()=>{this.$router.push("/")})).catch((e=>{console.error("Помилка при виході: ",e)}))},async deleteAccount(){const e=(0,P.xI)(),t=(0,$.aU)();try{await(0,$.kd)((0,$.H9)(t,"users",this.userData.uid)),await e.currentUser.delete(),this.$router.push("/")}catch(a){console.error("Помилка при видаленні акаунта: ",a)}},async unblockUser(e){const t=(0,$.aU)(),a=(0,$.H9)(t,"users",e);await(0,$.mZ)(a,{status:"active"}),this.fetchBlockedUsers()},triggerFileInput(){console.log("Клік на зображення"),this.$refs.fileInput.click()},handleFileChange(e){const t=e.target.files[0];if(t){const e=(0,tt.c7)(),a=(0,tt.KR)(e,`profile_pictures/${this.userData.uid}`);(0,tt.D)(a,t).then((e=>{(0,tt.qk)(e.ref).then((e=>{this.updateProfilePicture(e)}))}))}},async updateProfilePicture(e){const t=(0,$.aU)(),a=(0,$.H9)(t,"users",this.userData.uid);await(0,$.mZ)(a,{profilePicture:e}),this.userData.profilePicture=e}},mounted(){const e=(0,P.xI)();(0,P.hg)(e,(e=>{e?this.fetchUserData(e.uid):this.$router.push("/")}))}},st=(0,r.A)(at,[["render",et],["__scopeId","data-v-26134d62"]]),it=st,ot={class:"create"},rt={class:"island-create"},nt={class:"b-c"},lt={class:"l-c"},ct={key:0,class:"suggestions"},ut=["onClick"],dt={ref:"mapContainer",class:"location-map"},pt={class:"b-c"},ht={class:"l-c"},gt={class:"b-c-det"},mt={class:"location-buttons"};function kt(e,t,a,o,r,n){const l=(0,i.g2)("Navbar");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(l),(0,i.Lk)("div",ot,[(0,i.Lk)("div",rt,[t[19]||(t[19]=(0,i.Lk)("p",{class:"location-title"},"Створення локації",-1)),(0,i.Lk)("div",nt,[(0,i.Lk)("div",lt,[t[15]||(t[15]=(0,i.Lk)("p",{class:"p-t"},"Додайте локацію",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchQuery=e),onInput:t[1]||(t[1]=(...e)=>n.fetchSuggestions&&n.fetchSuggestions(...e)),onKeydown:[t[2]||(t[2]=(0,s.jR)((e=>n.highlightSuggestion(1)),["down"])),t[3]||(t[3]=(0,s.jR)((e=>n.highlightSuggestion(-1)),["up"])),t[4]||(t[4]=(0,s.jR)(((...e)=>n.selectHighlighted&&n.selectHighlighted(...e)),["enter"]))],type:"text",placeholder:"Введіть адресу",class:"address-input"},null,544),[[s.Jo,r.searchQuery]]),r.suggestions.length?((0,i.uX)(),(0,i.CE)("ul",ct,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.suggestions,((e,t)=>((0,i.uX)(),(0,i.CE)("li",{key:t,class:(0,d.C4)({active:t===r.highlighted}),onClick:t=>n.selectSuggestion(e)},(0,d.v_)(e.place_name),11,ut)))),128))])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",dt,null,512)]),(0,i.Lk)("div",pt,[(0,i.Lk)("div",ht,[t[16]||(t[16]=(0,i.Lk)("p",{class:"p-t"},"Додайте зображення",-1)),(0,i.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>n.uploadImage&&n.uploadImage(...e)),class:"c-button"},"Додати фото"),(0,i.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>n.removeImage&&n.removeImage(...e)),class:"c-button"},"Видалити фото")]),r.imageUrl?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"image-preview",style:(0,d.Tr)({backgroundImage:`url(${r.imageUrl})`})},null,4)):((0,i.uX)(),(0,i.CE)("div",{key:1,class:"image-upload-area",onDrop:t[7]||(t[7]=(0,s.D$)(((...t)=>e.onDrop&&e.onDrop(...t)),["prevent"])),onDragover:t[8]||(t[8]=(0,s.D$)((()=>{}),["prevent"])),onDragstart:t[9]||(t[9]=(...e)=>n.startDrag&&n.startDrag(...e)),onDragend:t[10]||(t[10]=(...e)=>n.endDrag&&n.endDrag(...e)),style:(0,d.Tr)(r.dragStyle),draggable:"true"},t[17]||(t[17]=[(0,i.Lk)("span",null,"Перетягніть фото сюди",-1)]),36))]),(0,i.Lk)("div",gt,[t[18]||(t[18]=(0,i.Lk)("p",{class:"p-t"},"Створіть опис",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>r.locationName=e),type:"text",placeholder:"Введіть назву",class:"det-inp",required:""},null,512),[[s.Jo,r.locationName]]),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>r.locationDescription=e),type:"text",placeholder:"Введіть опис",class:"det-inp"},null,512),[[s.Jo,r.locationDescription]])]),(0,i.Lk)("div",mt,[(0,i.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>n.saveLocation&&n.saveLocation(...e)),class:"c-button b"},"Зберегти"),(0,i.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>n.cancel&&n.cancel(...e)),class:"c-button b"},"Скасувати")])])])],64)}z().accessToken="pk.eyJ1IjoibHZxMWljZW1hbiIsImEiOiJjbHU4ZmtuZ2MwYzRvMm9yeGQzZnBycjBkIn0.u4QC3601L2OcFCzw8kzvmw";const vt={name:"CreateLocation",components:{Navbar:N},data(){return{map:null,marker:null,searchQuery:"",suggestions:[],highlighted:-1,imageUrl:"",locationName:"",locationDescription:"",isDragging:!1,dragStyle:{},locationCoords:null,imageFile:null}},methods:{async fetchSuggestions(){if(!this.searchQuery)return void(this.suggestions=[]);const e=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(this.searchQuery)}.json?access_token=${z().accessToken}&autocomplete=true&limit=5`),t=await e.json();this.suggestions=t.features},selectSuggestion(e){this.searchQuery=e.place_name,this.suggestions=[];const[t,a]=e.center;this.setMarker(t,a)},highlightSuggestion(e){const t=this.suggestions.length-1;t<0||(this.highlighted+=e,this.highlighted<0&&(this.highlighted=t),this.highlighted>t&&(this.highlighted=0))},selectHighlighted(){this.highlighted>=0&&this.highlighted<this.suggestions.length&&this.selectSuggestion(this.suggestions[this.highlighted])},setMarker(e,t){this.map&&(this.map.flyTo({center:[e,t],zoom:14}),this.marker?this.marker.setLngLat([e,t]):(this.marker=new(z().Marker)({color:"red",draggable:!0}).setLngLat([e,t]).addTo(this.map),this.marker.on("dragend",this.reverseGeocodeMarker)),this.reverseGeocodeMarker(),this.locationCoords={lng:e,lat:t})},async reverseGeocodeMarker(){const e=this.marker.getLngLat(),t=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e.lng},${e.lat}.json?access_token=${z().accessToken}`),a=await t.json();a.features[0]&&(this.searchQuery=a.features[0].place_name)},uploadImage(){const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{if(this.imageFile=e.target.files[0],this.imageFile){const e=new FileReader;e.onload=e=>{this.imageUrl=e.target.result},e.readAsDataURL(this.imageFile)}},e.click()},removeImage(){this.imageFile=null,this.imageUrl=""},startDrag(){this.isDragging=!0,this.dragStyle={cursor:"grabbing",opacity:.7}},endDrag(){this.isDragging=!1,this.dragStyle={}},async saveLocation(){if(!this.locationName||!this.searchQuery||!this.imageFile||!this.locationCoords)return void alert("Будь ласка, заповніть всі обов'язкові поля!");const e=(0,tt.c7)(),t=(0,tt.KR)(e,`locations/${Date.now()}_${this.imageFile.name}`);try{const e=await(0,tt.D)(t,this.imageFile),a=await(0,tt.qk)(e.ref),s=(0,$.aU)(),i=(0,P.xI)(),o=i.currentUser;let r="Без імені";const n=(0,$.H9)(s,"users",o.uid),l=await(0,$.x7)(n);l.exists()&&(r=l.data().username||r);const c=(0,$.rJ)(s,"locations");await(0,$.gS)(c,{name:this.locationName,description:this.locationDescription,address:this.searchQuery,coordinates:this.locationCoords,userUid:o.uid,username:r,imageUrl:a,status:"pending",createdAt:$.Dc.fromDate(new Date)}),alert("Локацію успішно додано!"),this.clearForm()}catch(a){console.error("Error saving location:",a),alert("Сталася помилка при збереженні локації.")}},clearForm(){this.searchQuery="",this.locationName="",this.locationDescription="",this.imageFile=null,this.imageUrl="",this.locationCoords=null},cancel(){this.$router.push("/home")}},mounted(){this.map=new(z().Map)({container:this.$refs.mapContainer,center:[24.0315,49.8397],zoom:10,style:"mapbox://styles/lvq1iceman/cm9ootxch009b01qs40wa1c8q"}),this.map.on("load",(()=>{this.map.resize()})),this.map.on("click",(e=>{this.setMarker(e.lngLat.lng,e.lngLat.lat)}))}},bt=(0,r.A)(vt,[["render",kt],["__scopeId","data-v-4b17961c"]]),ft=bt,Lt={class:"approve-container"},yt={class:"approve-card-title"},wt={class:"approve-card-header"},Ct={class:"approve-card-header-l"},Dt=["src"],Et=["onClick"],Ut=["onClick"],It=["src"],_t={class:"approve-card-footer"},Ft={class:"approve-card-street"},xt={class:"approve-card-description"};function Xt(e,t,a,s,o,r){const n=(0,i.g2)("Navbar");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(n),(0,i.Lk)("div",Lt,[t[1]||(t[1]=(0,i.Lk)("p",{class:"approve-title"},"Заявки на публікацію",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.requests,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"approve-card"},[(0,i.Lk)("p",yt," Користувач @"+(0,d.v_)(e.username)+" бажає опублікувати: ",1),(0,i.Lk)("div",wt,[(0,i.Lk)("div",Ct,[(0,i.Lk)("img",{class:"profile-photo",src:e.profilePicture,alt:"profile"},null,8,Dt),(0,i.Lk)("button",{class:"approve",onClick:t=>r.approveRequest(e.id)}," Схвалити ",8,Et),(0,i.Lk)("button",{class:"reject",onClick:t=>r.rejectRequest(e.id)}," Відхилити ",8,Ut)]),(0,i.Lk)("img",{class:"approve-card-header-r",src:e.imageUrl,alt:"location"},null,8,It)]),(0,i.Lk)("div",_t,[(0,i.Lk)("p",Ft,(0,d.v_)(e.address),1),t[0]||(t[0]=(0,i.Lk)("hr",null,null,-1)),(0,i.Lk)("p",xt,(0,d.v_)(e.description),1)])])))),128))])],64)}const Qt={name:"Approve",components:{Navbar:N},data(){return{requests:[]}},async mounted(){const e=(0,$.aU)(),t=(0,$.P)((0,$.rJ)(e,"locations"),(0,$._M)("status","==","pending")),a=await(0,$.GG)(t),s=await Promise.all(a.docs.map((async t=>{const a=t.data(),s=a.userUid;let i="/default-avatar.png";if(s){const t=(0,$.H9)(e,"users",s),a=await(0,$.x7)(t);a.exists()&&(i=a.data().profilePicture||i)}return{id:t.id,...a,profilePicture:i}})));this.requests=s},methods:{async getUserPhotoByUsername(e){const t=(0,$.aU)(),a=(0,$.rJ)(t,"users"),s=(0,$.P)(a,(0,$._M)("username","==",e)),i=await(0,$.GG)(s);if(!i.empty){const e=i.docs[0];return e.data().photoURL||null}return null},async approveRequest(e){const t=(0,$.aU)();await(0,$.mZ)((0,$.H9)(t,"locations",e),{status:"approved"}),this.requests=this.requests.filter((t=>t.id!==e))},async rejectRequest(e){const t=(0,$.aU)();await(0,$.mZ)((0,$.H9)(t,"locations",e),{status:"rejected"}),this.requests=this.requests.filter((t=>t.id!==e))}}},Mt=(0,r.A)(Qt,[["render",Xt],["__scopeId","data-v-5de718e1"]]),jt=Mt,At={class:"publications"},Pt={class:"publication-grid"},$t=["onMouseenter","onMouseleave"],St=["src"],Ht={class:"publication-address-mobile"},Nt=["onClick"];function qt(e,t,a,s,o,r){const n=(0,i.g2)("Navbar"),l=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(n),(0,i.Lk)("div",At,[t[2]||(t[2]=(0,i.Lk)("p",{class:"publication-title"},"Мої публікації",-1)),(0,i.Lk)("div",Pt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.publications,(e=>((0,i.uX)(),(0,i.CE)("div",{class:"publication-card",key:e.id,onMouseenter:t=>e.showActions=!0,onMouseleave:t=>e.showActions=!1},[(0,i.Lk)("img",{src:e.imageUrl,alt:"Publication Image",class:"publication-image"},null,8,St),(0,i.Lk)("div",{class:(0,d.C4)(["action-container",{"show-actions":e.showActions}])},[(0,i.Lk)("p",Ht,(0,d.v_)(e.address),1),(0,i.bF)(l,{to:"/edit-location/"+e.id,class:"action"},{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.eW)("Редагувати")]))),_:2},1032,["to"]),t[1]||(t[1]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("button",{class:"action",onClick:t=>r.deletePublication(e.id)}," Видалити ",8,Nt)],2)],40,$t)))),128))])])],64)}const zt={name:"MyPublications",components:{Navbar:N},data(){return{publications:[],userUid:"",isMounted:!1}},methods:{async deletePublication(e){const t=(0,$.aU)(),a=(0,$.H9)(t,"locations",e);await(0,$.kd)(a),this.publications=this.publications.filter((t=>t.id!==e))},editPublication(e){}},async mounted(){const e=(0,P.xI)(),t=(0,$.aU)();this.userUid=e.currentUser.uid,this.isMounted=!0;const a=(0,$.P)((0,$.rJ)(t,"locations"),(0,$._M)("userUid","==",this.userUid),(0,$._M)("status","==","approved")),s=await(0,$.GG)(a);this.isMounted&&(this.publications=s.docs.map((e=>({id:e.id,...e.data(),showActions:!1}))))},onBeforeUnmount(){this.isMounted=!1}},Jt=(0,r.A)(zt,[["render",qt],["__scopeId","data-v-18bdaea2"]]),Rt=Jt,Zt={class:"create"},Kt={class:"island-create"},Tt={class:"b-c"},Wt={class:"l-c"},Bt={key:0,class:"suggestions"},Gt=["onClick"],Ot={ref:"mapContainer",class:"location-map"},Vt={class:"b-c"},Yt={class:"l-c"},ea={class:"b-c-det"},ta={class:"location-buttons"};function aa(e,t,a,o,r,n){const l=(0,i.g2)("Navbar");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(l),(0,i.Lk)("div",Zt,[(0,i.Lk)("div",Kt,[t[19]||(t[19]=(0,i.Lk)("p",{class:"location-title"},"Редагування локації",-1)),(0,i.Lk)("div",Tt,[(0,i.Lk)("div",Wt,[t[15]||(t[15]=(0,i.Lk)("p",{class:"p-t"},"Додайте локацію",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchQuery=e),onInput:t[1]||(t[1]=(...e)=>n.fetchSuggestions&&n.fetchSuggestions(...e)),onKeydown:[t[2]||(t[2]=(0,s.jR)((e=>n.highlightSuggestion(1)),["down"])),t[3]||(t[3]=(0,s.jR)((e=>n.highlightSuggestion(-1)),["up"])),t[4]||(t[4]=(0,s.jR)(((...e)=>n.selectHighlighted&&n.selectHighlighted(...e)),["enter"]))],type:"text",placeholder:"Введіть адресу",class:"address-input"},null,544),[[s.Jo,r.searchQuery]]),r.suggestions.length?((0,i.uX)(),(0,i.CE)("ul",Bt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.suggestions,((e,t)=>((0,i.uX)(),(0,i.CE)("li",{key:t,class:(0,d.C4)({active:t===r.highlighted}),onClick:t=>n.selectSuggestion(e)},(0,d.v_)(e.place_name),11,Gt)))),128))])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",Ot,null,512)]),(0,i.Lk)("div",Vt,[(0,i.Lk)("div",Yt,[t[16]||(t[16]=(0,i.Lk)("p",{class:"p-t"},"Додайте зображення",-1)),(0,i.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>n.uploadImage&&n.uploadImage(...e)),class:"c-button"},"Змінити фото"),(0,i.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>n.removeImage&&n.removeImage(...e)),class:"c-button"},"Видалити фото")]),r.imageUrl?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"image-preview",style:(0,d.Tr)({backgroundImage:`url(${r.imageUrl})`})},null,4)):((0,i.uX)(),(0,i.CE)("div",{key:1,class:"image-upload-area",onDrop:t[7]||(t[7]=(0,s.D$)(((...t)=>e.onDrop&&e.onDrop(...t)),["prevent"])),onDragover:t[8]||(t[8]=(0,s.D$)((()=>{}),["prevent"])),onDragstart:t[9]||(t[9]=(...e)=>n.startDrag&&n.startDrag(...e)),onDragend:t[10]||(t[10]=(...e)=>n.endDrag&&n.endDrag(...e)),style:(0,d.Tr)(r.dragStyle),draggable:"true"},t[17]||(t[17]=[(0,i.Lk)("span",null,"Перетягніть фото сюди",-1)]),36))]),(0,i.Lk)("div",ea,[t[18]||(t[18]=(0,i.Lk)("p",{class:"p-t"},"Створіть опис",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>r.locationName=e),type:"text",placeholder:"Введіть назву",class:"det-inp",required:""},null,512),[[s.Jo,r.locationName]]),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>r.locationDescription=e),type:"text",placeholder:"Введіть опис",class:"det-inp"},null,512),[[s.Jo,r.locationDescription]])]),(0,i.Lk)("div",ta,[(0,i.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>n.saveLocation&&n.saveLocation(...e)),class:"c-button b"},"Зберегти"),(0,i.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>n.cancel&&n.cancel(...e)),class:"c-button b"},"Скасувати")])])])],64)}z().accessToken="pk.eyJ1IjoibHZxMWljZW1hbiIsImEiOiJjbHU4ZmtuZ2MwYzRvMm9yeGQzZnBycjBkIn0.u4QC3601L2OcFCzw8kzvmw";const sa={name:"EditLocation",components:{Navbar:N},data(){return{map:null,marker:null,searchQuery:"",suggestions:[],highlighted:-1,imageUrl:"",locationName:"",locationDescription:"",isDragging:!1,dragStyle:{},locationCoords:null,imageFile:null,locationId:""}},methods:{async fetchSuggestions(){if(!this.searchQuery)return void(this.suggestions=[]);const e=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(this.searchQuery)}.json?access_token=${z().accessToken}&autocomplete=true&limit=5`),t=await e.json();this.suggestions=t.features},selectSuggestion(e){this.searchQuery=e.place_name,this.suggestions=[];const[t,a]=e.center;this.setMarker(t,a)},highlightSuggestion(e){const t=this.suggestions.length-1;t<0||(this.highlighted+=e,this.highlighted<0&&(this.highlighted=t),this.highlighted>t&&(this.highlighted=0))},selectHighlighted(){this.highlighted>=0&&this.highlighted<this.suggestions.length&&this.selectSuggestion(this.suggestions[this.highlighted])},setMarker(e,t){this.map&&(this.map.flyTo({center:[e,t],zoom:14}),this.marker?this.marker.setLngLat([e,t]):(this.marker=new(z().Marker)({color:"red",draggable:!0}).setLngLat([e,t]).addTo(this.map),this.marker.on("dragend",this.reverseGeocodeMarker)),this.reverseGeocodeMarker(),this.locationCoords={lng:e,lat:t})},async reverseGeocodeMarker(){const e=this.marker.getLngLat(),t=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e.lng},${e.lat}.json?access_token=${z().accessToken}`),a=await t.json();a.features[0]&&(this.searchQuery=a.features[0].place_name)},uploadImage(){const e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{if(this.imageFile=e.target.files[0],this.imageFile){const e=new FileReader;e.onload=e=>{this.imageUrl=e.target.result},e.readAsDataURL(this.imageFile)}},e.click()},removeImage(){this.imageFile=null,this.imageUrl=""},startDrag(){this.isDragging=!0,this.dragStyle={cursor:"grabbing",opacity:.7}},endDrag(){this.isDragging=!1,this.dragStyle={}},async loadLocationData(){const e=(0,$.aU)(),t=(0,$.H9)(e,"locations",this.$route.params.id),a=await(0,$.x7)(t);if(a.exists()){const e=a.data();this.locationId=a.id,this.locationName=e.name,this.locationDescription=e.description,this.searchQuery=e.address,this.locationCoords=e.coordinates,this.imageUrl=e.imageUrl,this.setMarker(e.coordinates.lng,e.coordinates.lat)}},async saveLocation(){if(!this.locationName||!this.searchQuery||!this.locationCoords)return void alert("Будь ласка, заповніть всі обов'язкові поля!");let e=this.imageUrl;if(this.imageFile){const t=(0,tt.c7)(),a=(0,tt.KR)(t,`locations/${Date.now()}_${this.imageFile.name}`);try{const t=await(0,tt.D)(a,this.imageFile);e=await(0,tt.qk)(t.ref)}catch(l){return console.error("Error uploading image:",l),void alert("Сталася помилка при завантаженні фото.")}}const t=(0,$.aU)(),a=(0,P.xI)(),s=a.currentUser;let i="Без імені";const o=(0,$.H9)(t,"users",s.uid),r=await(0,$.x7)(o);r.exists()&&(i=r.data().username||i);const n=(0,$.H9)(t,"locations",this.locationId);try{await(0,$.mZ)(n,{name:this.locationName,description:this.locationDescription,address:this.searchQuery,coordinates:this.locationCoords,userUid:s.uid,username:i,imageUrl:e,status:"pending",updatedAt:$.Dc.fromDate(new Date)}),alert("Локацію успішно оновлено!"),this.$router.push("/my-publications")}catch(l){console.error("Error saving location:",l),alert("Сталася помилка при збереженні локації.")}},cancel(){this.$router.push("/my-publications")}},mounted(){this.loadLocationData(),this.map=new(z().Map)({container:this.$refs.mapContainer,style:"mapbox://styles/mapbox/streets-v11",center:[25,49],zoom:8})}},ia=(0,r.A)(sa,[["render",aa],["__scopeId","data-v-0812c3ca"]]),oa=ia,ra=[{path:"/",name:"start",component:oe},{path:"/home",name:"home",component:Z},{path:"/login",name:"login",component:me},{path:"/registration",name:"registration",component:Ie},{path:"/profile",name:"profile",component:it,meta:{requiresAuth:!0}},{path:"/create-location",name:"create-location",component:ft,meta:{requiresAuth:!0}},{path:"/approve",name:"approve",component:jt,meta:{requiresAuth:!0}},{path:"/my-publications",name:"my-publications",component:Rt,meta:{requiresAuth:!0}},{path:"/edit-location/:id",name:"edit-location",component:oa,meta:{requiresAuth:!0},props:!0}],na=(0,u.aE)({history:(0,u.LA)("/"),routes:ra}),la=()=>new Promise(((e,t)=>{const a=(0,P.hg)((0,P.xI)(),(t=>{a(),e(t)}),t)}));na.beforeEach((async(e,t,a)=>{e.matched.some((e=>e.meta.requiresAuth))?await la()?a():(console.log("You are not logged in"),a("/login")):a()}));const ca=na;var ua=a(223);(0,s.Ef)(c).use(ca).mount("#app");const da={apiKey:"AIzaSyA_e0D4JlvkLdZvTE3PA7hy0W15wTXuMxI",authDomain:"kursova-5374b.firebaseapp.com",databaseURL:"https://kursova-5374b-default-rtdb.europe-west1.firebasedatabase.app",projectId:"kursova-5374b",storageBucket:"kursova-5374b.appspot.com",messagingSenderId:"444568413958",appId:"1:444568413958:web:e4258c7fa4134d96fee087"},pa=(0,ua.Wp)(da);(0,$.aU)(pa),(0,tt.c7)(pa)}},t={};function a(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,a),o.exports}a.m=e,(()=>{var e=[];a.O=(t,s,i,o)=>{if(!s){var r=1/0;for(u=0;u<e.length;u++){for(var[s,i,o]=e[u],n=!0,l=0;l<s.length;l++)(!1&o||r>=o)&&Object.keys(a.O).every((e=>a.O[e](s[l])))?s.splice(l--,1):(n=!1,o<r&&(r=o));if(n){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[s,i,o]}})(),(()=>{a.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return a.d(t,{a:t}),t}})(),(()=>{a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{a.p="/"})(),(()=>{var e={524:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var i,o,[r,n,l]=s,c=0;if(r.some((t=>0!==e[t]))){for(i in n)a.o(n,i)&&(a.m[i]=n[i]);if(l)var u=l(a)}for(t&&t(s);c<r.length;c++)o=r[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},s=self["webpackChunkdiploma_bach"]=self["webpackChunkdiploma_bach"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=a.O(void 0,[504],(()=>a(330)));s=a.O(s)})();
//# sourceMappingURL=app.d4e8bfe6.js.map